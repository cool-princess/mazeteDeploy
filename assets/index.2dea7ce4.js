import{j as k,u as w,r as s,v as R,a as F,b as J,c as M,B as P,R as z,d as B,e as q,f as H}from"./vendor.a7a49f7b.js";const K=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))i(u);new MutationObserver(u=>{for(const t of u)if(t.type==="childList")for(const f of t.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function d(u){const t={};return u.integrity&&(t.integrity=u.integrity),u.referrerpolicy&&(t.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?t.credentials="include":u.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function i(u){if(u.ep)return;u.ep=!0;const t=d(u);fetch(u.href,t)}};K();const e=k.exports.jsx,r=k.exports.jsxs,$=k.exports.Fragment,U="https://mazete-api-dev.pechakucha.ai";function W(){const l=w();return s.exports.useEffect(()=>{let o=R();var d=JSON.stringify({register_id:o}),i={method:"post",url:`${U}/register_id`,headers:{"Content-Type":"application/json"},data:d};F(i).then(u=>{localStorage.setItem("register_id",o)}).catch(u=>{l("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}),e("div",{className:"container",children:r("div",{className:"container-wrap",children:[e("div",{className:"top-header",children:e("h1",{children:"\u30DE\u305C\u3066"})}),r("div",{className:"top-banner",children:[e("img",{src:"/assets/image/top-banner-img01.png",alt:"",className:"top-banner01"}),e("img",{src:"/assets/image/top-banner-img02.png",alt:"",className:"top-banner02"}),e("img",{src:"/assets/image/top-banner-img03.png",alt:"",className:"top-banner03"}),e("img",{src:"/assets/image/top-banner-img04.png",alt:"",className:"top-banner04"}),e("div",{className:"top-banner-text",children:"\u203B\u30B5\u30FC\u30D3\u30B9\u5185\u5BB9\u4F1D\u308F\u308B\u30A4\u30E9\u30B9\u30C8\u5916\u6CE8"})]}),e("a",{href:"/select",className:"start-btn",children:"\u30B9\u30BF\u30FC\u30C8"}),e("div",{className:"top-banner-border"}),r("div",{className:"top-delusion",children:[e("div",{className:"top-delusion-title",children:"\u307F\u3093\u306A\u306E\u5984\u60F3"}),r("div",{className:"top-delusion-body",children:[e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img01.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img02.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img03.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img04.png",alt:"",className:"top-delusion-img"})})]})]})]})})}const D="https://mazete-api-dev.pechakucha.ai";function G(){const l=w(),[o,d]=s.exports.useState(1),[i,u]=s.exports.useState([]),[t,f]=s.exports.useState(null),[b,x]=s.exports.useState(!1),[_,y]=s.exports.useState([]),[E,C]=s.exports.useState([]);s.exports.useEffect(()=>{let a=localStorage.register_id||null;a||window.location.assign("/");let n=JSON.stringify({user_id:a,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),c={method:"post",url:`${D}/get_chara_list`,headers:{"Content-Type":"application/json"},data:n};F(c).then(N=>{y(N.data.chara_list)}).catch(N=>{l("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})});let v=JSON.stringify({user_id:a,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),g={method:"post",url:`${D}/get_world_list`,headers:{"Content-Type":"application/json"},data:v};F(g).then(N=>{C(N.data.world_list)}).catch(N=>{l("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]),s.exports.useEffect(()=>{t&&i.length>0&&x(!0)},[i,t]);const m=a=>{let n=i;if(n.includes(a)){for(let c=0;c<n.length;c++)n[c]===a&&(n.splice(c,1),c--);u([...n])}else n.length<3&&(n.push(a),u([...n]))},h=()=>{let a=localStorage.register_id||null,n=JSON.stringify({user_id:a,chosen_chara_ids:i.toString(),chosen_world_ids:[t].toString()}),c={method:"post",url:`${D}/generate_outline`,headers:{"Content-Type":"application/json"},data:n};F(c).then(v=>{localStorage.setItem("outline_id",v.data.outline_id),localStorage.setItem("background",E.filter(g=>g.world_id==t)[0].img_url),localStorage.setItem("user_list",JSON.stringify(i.map(g=>_.filter(N=>N.chara_id==g)[0].img_url))),window.location.assign("/synopsis")}).catch(v=>{l("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};return e("div",{className:"container",id:"character_select",children:r("div",{className:"container-wrap",children:[r("div",{className:"preview",children:[r("div",{className:"preview-part",onClick:()=>d(1),children:[r("div",{className:"preview-img-part",children:[i.map(a=>e("img",{src:_.filter(n=>n.chara_id==a)[0].img_url,alt:""},a)),i.length==0&&e("img",{src:"/assets/image/default-avatar.png"})]}),e("div",{className:o===1?"preview-title-part active":"preview-title-part",children:"\u30AD\u30E3\u30E9"})]}),r("div",{className:"preview-part",onClick:()=>{d(2)},children:[e("div",{className:"preview-img-part",children:e("img",{src:t!=null?E.filter(a=>a.world_id==t)[0].img_url:"/assets/image/point-bg.png",alt:""})}),e("div",{className:o===2?"preview-title-part active":"preview-title-part",children:"\u4E16\u754C"})]})]}),r("div",{className:"point-select",children:[r("div",{className:"point-search",children:[e("input",{type:"text"}),e("button",{type:"button",className:"search-btn",children:e("img",{src:"/assets/image/point-search.png",alt:""})})]}),r("div",{className:"point-body",children:[o===1&&e("div",{className:"point-body-wrap",children:_.map((a,n)=>r("div",{onClick:()=>m(a.chara_id),className:`${i.includes(a.chara_id)?"active":""} character-item`,children:[e("img",{src:a.img_url,alt:""}),e("span",{})]},n))}),o==2&&e("div",{className:"point-body-wrap",children:E.map((a,n)=>r("div",{className:`${t==a.world_id?"active":""} location-item`,onClick:c=>{f(a.world_id)},children:[e("img",{src:a.img_url,alt:""}),e("span",{})]},n))}),e("button",{onClick:h,className:`character-add-btn ${b?"active":""}`,disabled:!b,children:"\u30DE\u305C\u308B"})]})]})]})})}const O="https://mazete-api-dev.pechakucha.ai";function Q(){const l=w(),o=s.exports.useRef(),[d,i]=s.exports.useState(!1),[u,t]=s.exports.useState(!0),[f,b]=s.exports.useState(`\u30D3\u30EB\u306E\u5C4B\u4E0A\u306B\u3042\u3064\u3081\u3089\u308C\u305F\u30B4\u30F3\u9054\u3002

\u5229\u6839\u5DDD\u304B\u3089\u9244\u9AA8\u306E\u4E0A\u3092\u6E21\u3063\u3066\u3001\u5411\u3053\u3046\u306E\u30D3\u30EB\u3078\u884C\u3051\u305F\u3082\u306E\u306B\u8CDE\u91D1\u304C\u3082\u3089\u3048\u308B\u3068\u8AAC\u660E\u3092\u53D7\u3051\u308B\u3002

\u30B4\u30F3\u9054\u306F\u3044\u304B\u306B\u3057\u3066\u3053\u306E\u5371\u6A5F\u3092\u4E57\u308A\u8D8A\u3048\u308B\u306E\u304B\uFF1F`),[x,_]=s.exports.useState([]),[y,E]=s.exports.useState(null);s.exports.useEffect(()=>{let m=localStorage.register_id||null,h=localStorage.outline_id||null,a=localStorage.background||null,n=localStorage.user_list||null;console.log(n,a),(!n||!a)&&l("/select",{state:{}}),E(a),_(JSON.parse(n));let c=JSON.stringify({user_id:m,outline_id:h}),v={method:"post",url:`${O}/get_outline`,headers:{"Content-Type":"application/json"},data:c};F(v).then(g=>{g.data.generated&&g.data.outline&&!g.data.error?(t(!1),b(g.data.outline)):l("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(g=>{l("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]);const C=()=>{let m=localStorage.register_id||null,h=localStorage.outline_id||null,a=JSON.stringify({user_id:m,outline_id:h,outline:f}),n={method:"post",url:`${O}/generate_story`,headers:{"Content-Type":"application/json"},data:a};F(n).then(c=>{window.location.assign(`/talk/${c.data.story_id}`)}).catch(c=>{l("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};return s.exports.useEffect(()=>{o.current&&d&&o.current.focus()},[d]),e("div",{className:"container",id:"loading_synposis",children:r("div",{className:"container-wrap",children:[e("div",{className:"ls-top editing",children:e("div",{className:"ls-top-wrap",style:{backgroundImage:`url(${y}`},children:e("div",{className:"ls-top-body",children:x.map((m,h)=>e("div",{className:"ls-top-item",children:e("img",{src:m,alt:""})},h))})})}),r("div",{className:"ls-main",children:[e("div",{className:"ls-main-title",children:"\u3042\u3089\u3059\u3058"}),r("div",{className:"ls-main-loading-text",children:[u&&r("div",{className:"ls-main-loading-part",children:[e("img",{src:"/assets/image/white-loading.gif",alt:""}),e("span",{children:"\u4E0B\u66F8\u304D\u6E96\u5099\u4E2D"})]}),!u&&e("textarea",{ref:o,className:"ls-main-loading-wrap",value:f,disabled:!d,onChange:m=>{b(m.target.value)},onBlur:()=>{i(!1)}})]}),!d&&e("div",{className:"ls-main-edit-btn",children:r("a",{onClick:()=>{o.current.focus(),i(!0)},children:[e("span",{children:"\u7DE8\u96C6"}),e("img",{src:"/assets/image/edit-icon.png",alt:""})]})}),!d&&e("button",{onClick:C,className:u?"ls-main-making-btn":"ls-main-making-btn active",disabled:u,children:"\u3053\u306E\u4E16\u754C\u7DDA\u306B\u5165\u308B"})]})]})})}const V="https://mazete-api-dev.pechakucha.ai";function X(l){return new Promise(o=>setTimeout(o,l))}function Y(){const l=w(),[o,d]=s.exports.useState(!0),[i,u]=s.exports.useState(null),[t,f]=s.exports.useState(0),[b,x]=s.exports.useState(null),[_,y]=s.exports.useState(null),[E,C]=s.exports.useState([]),[m,h]=s.exports.useState(!1),[a,n]=s.exports.useState(!1),[c,v]=s.exports.useState(!1);let{story_id:g}=J();s.exports.useEffect(()=>{let p=localStorage.register_id||null,A=JSON.stringify({user_id:p,story_id:g}),I={method:"post",url:`${V}/get_story`,headers:{"Content-Type":"application/json"},data:A};F(I).then(S=>{d(!1),S.data.generated&&!S.data.error?(d(!1),u(S.data)):l("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(S=>{l("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]),s.exports.useEffect(()=>{i&&N()},[i,t]);const N=()=>{let p=i.story;y(p[t].chara_img_url),x(p[t].position),p[t].multiple?(h(!0),C(p[t].content)):(h(!1),T(p[t].content))},T=async p=>{v(!0);for(var A=0;A<p.length;)C([p.substring(0,A+1)]),A++,await X(75);v(!1),i.story.length-1==t&&n(!0)},j=p=>{m&&(h(!1),T(p))},L=()=>{console.log(i.story),c||i.story.length-1>t&&f(t+1)};return r($,{children:[o&&r("div",{className:"container",id:"loading_adventure",children:[e("div",{className:"container-wrap",children:r("div",{className:"la-wrap",children:[e("img",{src:"/assets/image/black-loading.gif",alt:""}),e("span",{children:"\u6E96\u5099\u4E2D"})]})}),e("button",{className:"back-to-btn",onClick:()=>{l("/synopsis",{state:{}})},children:e("img",{src:"/assets/image/back-to-img.svg",alt:""})})]}),!o&&r("div",{className:"container",id:"adventure_state",children:[r("div",{className:"container-wrap",children:[e("div",{className:"as-thumb",style:{backgroundImage:`url(${i==null?void 0:i.background_url})`},children:_&&e("img",{src:_,alt:"",className:`as-thumb-character ${b==0?"lb":b==1?"mb":"rb"}`})}),e("div",{className:"as-text",children:E.map((p,A)=>e("div",{className:"as-text-wrap",onClick:()=>{j(p)},children:p},A))}),!a&&r("div",{className:"text-select-btn-group",children:[!m&&e("a",{onClick:L,className:"next-btn",children:"\u30BF\u30C3\u30D7\u3057\u3066\u6B21\u3078\xA0\xA0\u25B6"}),m&&e("a",{className:"next-btn active",children:"\u9078\u629E\u3057\u3066\u4E0B\u3055\u3044\xA0\xA0\u25B6"})]}),a&&r("div",{className:"text-select-btn-group",children:[e("a",{href:"",className:"final-btn",children:"\u3082\u3046\u4E00\u5EA6\u898B\u308B"}),e("a",{href:"",className:"final-btn",children:"\u3053\u306E\u7269\u8A9E\u3092\u30B7\u30A7\u30A2\u3059\u308B"})]})]}),e("button",{className:"back-to-btn",onClick:()=>{l("/synopsis",{state:{}})},children:e("img",{src:"/assets/image/back-to-img.svg",alt:""})})]})]})}function Z(){const l=M();return console.log(l),e("div",{className:"flex-center position-ref full-height full-width bg-white",children:e("div",{className:"message",style:{padding:"10px"},dangerouslySetInnerHTML:{__html:l.state.message}})})}function ee(){return e(P,{children:r(z,{children:[e(B,{path:"/",element:e(W,{})}),e(B,{path:"/select",element:e(G,{})}),e(B,{path:"/synopsis",element:e(Q,{})}),e(B,{path:"/talk/:id",element:e(Y,{})}),e(B,{path:"/error",element:e(Z,{})})]})})}function te(){return e($,{children:e(ee,{})})}q.render(e(H.StrictMode,{children:e(te,{})}),document.getElementById("root"));
